---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: openldap
  namespace: flux-system
spec:
  chart:
    spec:
      chart: openldap-stack-ha
      sourceRef:
        kind: HelmRepository
        name: openldap
      version: 2.1.6
  interval: 1m0s
  targetNamespace: authentication
  values:
    adminPassword: Not@SecurePassw0rd
    configPassword: Not@SecurePassw0rd
    customFileSets: []
    customTLS:
      CA:
        enabled: false
      enabled: false
      secret: ""
    env:
      CONTAINER_LOG_LEVEL: "4"
      KEEP_EXISTING_CONFIG: "false"
      LDAP_BACKEND: mdb
      LDAP_DOMAIN: example.org
      LDAP_LOG_LEVEL: "256"
      LDAP_ORGANISATION: Example Inc.
      LDAP_READONLY_USER: "false"
      LDAP_READONLY_USER_PASSWORD: readonly
      LDAP_READONLY_USER_USERNAME: readonly
      LDAP_REMOVE_CONFIG_AFTER_SETUP: "true"
      LDAP_RFC2307BIS_SCHEMA: "false"
      LDAP_SSL_HELPER_PREFIX: ldap
      LDAP_TLS: "true"
      LDAP_TLS_CA_CRT_FILENAME: ca.crt
      LDAP_TLS_CIPHER_SUITE: NORMAL
      LDAP_TLS_CRT_FILENAME: tls.crt
      LDAP_TLS_DH_PARAM_FILENAME: dhparam.pem
      LDAP_TLS_ENFORCE: "false"
      LDAP_TLS_KEY_FILENAME: tls.key
      LDAP_TLS_PROTOCOL_MIN: "3.0"
      LDAP_TLS_REQCERT: never
      LDAP_TLS_VERIFY_CLIENT: never
    existingSecret: ""
    extraLabels: {}
    extraVolumeMounts: null
    extraVolumes: null
    image:
      pullPolicy: Always
      repository: osixia/openldap
      tag: 1.5.0
    livenessProbe:
      enabled: true
      failureThreshold: 10
      initialDelaySeconds: 20
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 1
    logLevel: info
    ltb-passwd:
      enabled: false
      ingress:
        annotations: {}
        enabled: false
        hosts:
        - ssl-ldap2.example
        path: /
        pathType: Prefix
      ldap:
        bindDN: cn=admin,dc=example,dc=org
        bindPWKey: LDAP_ADMIN_PASSWORD
        searchBase: dc=example,dc=org
        server: ldap://openldap-openldap-stack-ha
    nodeSelector: {}
    persistence:
      accessModes:
      - ReadWriteOnce
      enabled: true
      existingClaim: openldap-pvc
      size: 8Gi
    phpldapadmin:
      enabled: true
      env:
        PHPLDAPADMIN_LDAP_HOSTS: authentication-openldap-openldap-stack-ha
      ingress:
        annotations: {}
        enabled: false
        hosts:
        - phpldapadmin.example
        path: /
        pathType: Prefix
    podAnnotations: {}
    readinessProbe:
      enabled: true
      failureThreshold: 10
      initialDelaySeconds: 20
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 1
    replicaCount: 3
    replication:
      clusterName: cluster.local
      enabled: true
      interval: "00:00:00:10"
      retry: 60
      starttls: critical
      timeout: 1
      tls_reqcert: never
    resources: {}
    service:
      annotations: {}
      externalIPs: []
      ldapPort: 389
      sessionAffinity: None
      sslLdapPort: 636
      type: ClusterIP
    startupProbe:
      enabled: false
      failureThreshold: 30
      initialDelaySeconds: 0
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 1
    test:
      enabled: false
      image:
        repository: dduportal/bats
        tag: 0.4.0
    tolerations: []
    updateStrategy: {}

