---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: telegraf
  namespace: flux-system
spec:
  chart:
    spec:
      chart: telegraf
      sourceRef:
        kind: HelmRepository
        name: influxdata
      version: 1.8.2
  install: {}
  interval: 1m0s
  targetNamespace: influxdata
  values:
    affinity: {}
    args: []
    config:
      agent:
        collection_jitter: 0s
        debug: false
        flush_interval: 10s
        flush_jitter: 0s
        hostname: $HOSTNAME
        interval: 10s
        logfile: ""
        metric_batch_size: 1000
        metric_buffer_limit: 10000
        omit_hostname: false
        precision: ""
        quiet: false
        round_interval: true
      inputs:
      - statsd:
          allowed_pending_messages: 10000
          metric_separator: _
          percentile_limit: 1000
          percentiles:
          - 50
          - 95
          - 99
          service_address: :8125
      outputs:
      - influxdb:
          database: telegraf
          urls:
          - http://influxdb.monitoring.svc:8086
      processors:
      - enum:
          mapping:
            dest: status_code
            field: status
            value_mappings:
              critical: 3
              healthy: 1
              problem: 2
    env:
    - name: HOSTNAME
      value: telegraf-polling-service
    image:
      pullPolicy: IfNotPresent
      repo: telegraf
      tag: 1.18.3
    imagePullSecrets: []
    metrics:
      collect_memstats: false
      health:
        enabled: false
    nodeSelector: {}
    pdb:
      create: true
      minAvailable: 1
    podAnnotations: {}
    podLabels: {}
    rbac:
      clusterWide: false
      create: true
      rules: []
    replicaCount: 1
    resources: {}
    service:
      annotations: {}
      enabled: true
      type: ClusterIP
    serviceAccount:
      annotations: {}
      create: true
      name: null
    tolerations: []

